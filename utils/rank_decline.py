

_RANK_GENITIVE: dict[str, str] = {
    "рядовой": "рядового",
    "курсант": "курсанта",
    "младший сержант": "младшего сержанта",
    "сержант": "сержанта",
    "старший сержант": "старшего сержанта",
    "старшина": "старшины",
    "прапорщик": "прапорщика",
    "младший лейтенант": "младшего лейтенанта",
    "лейтенант": "лейтенанта",
    "старший лейтенант": "старшего лейтенанта",
    "капитан": "капитана",
    "майор": "майора",
    "подполковник": "подполковника",
    "полковник": "полковника",
    "генерал-майор": "генерал-майора",
    "генерал-лейтенант": "генерал-лейтенанта",
    "генерал-полковник": "генерал-полковника",
    "рядовой полиции": "рядового полиции",
    "сержант полиции": "сержанта полиции",
    "младший сержант полиции": "младшего сержанта полиции",
    "старший сержант полиции": "старшего сержанта полиции",
    "лейтенант полиции": "лейтенанта полиции",
    "младший лейтенант полиции": "младшего лейтенанта полиции",
    "старший лейтенант полиции": "старшего лейтенанта полиции",
    "капитан полиции": "капитана полиции",
    "майор полиции": "майора полиции",
    "подполковник полиции": "подполковника полиции",
    "полковник полиции": "полковника полиции",
    "генерал-майор полиции": "генерал-майора полиции",
    "генерал-лейтенант полиции": "генерал-лейтенанта полиции",
    "генерал-полковник полиции": "генерал-полковника полиции",
}


def decline_rank_genitive(rank: str) -> str:
    if not rank or not rank.strip():
        return rank
    s = rank.strip()
    lower = s.lower()
    if lower in _RANK_GENITIVE:
        result = _RANK_GENITIVE[lower]
        return result[0].upper() + result[1:] if len(result) > 1 else result.upper()
    if lower.endswith(" полиции"):
        base = lower[:-len(" полиции")].strip()
        if base in _RANK_GENITIVE:
            result = _RANK_GENITIVE[base] + " полиции"
            return result[0].upper() + result[1:]
    return s
